<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.kms.DAO.KmsMapper">

<!-- 로그인 정보 체크 -->
<select id="signIn">
<![CDATA[
	SELECT * FROM user WHERE id = #{id} AND password = #{password}
]]>
</select>

<!-- 세션 체크 -->
<select id="chkSessionById" resultType = "Hashmap">
<![CDATA[
	SELECT * FROM session WHERE userId = #{id}
]]>
</select>

<!-- 아이디로 세션 체크 -->
<select id="chkSessionBySId" resultType = "Hashmap">
<![CDATA[
	SELECT * FROM session WHERE userId = #{id}
]]>
</select>

<!-- 사용자 체크 -->
<select id="chkUser" resultType = "Hashmap">
<![CDATA[
	SELECT * FROM session WHERE userId = #{id}
]]>
</select>

<!-- 그룹 체크 -->
<select id="chkGroup" resultType = "Hashmap">
<![CDATA[
	SELECT * FROM `group` WHERE name = #{name}
]]>
</select>

<!-- 세션 생성 -->
<insert id = "createSession">
<![CDATA[
	INSERT INTO session (userId,sessionid) VALUES (#{id},#{sessionid})
]]>
</insert>

<!-- 유저 생성 -->
<insert id="createUser">
<![CDATA[
	INSERT INTO user (id,password,name,compId,phone,email,ctime) values (#{id},#{password},#{name},#{compId},#{phone},#{email},sysdate());
]]>
</insert>

<!-- 세션 생성 -->
<insert id = "createGroupUser">
<![CDATA[
	INSERT INTO group_user (groupId,userId) VALUES (#{groupid},#{userid})
]]>
</insert>

<!-- 권한 추가 -->
<update id="updateUserAuth">
<![CDATA[
	UPDATE user SET auth = #{auth} WHERE id= #{id};
]]>
</update>

<!-- 세션 삭제 -->
<delete id="deleteSessionById">
<![CDATA[
	DELETE FROM session WHERE userId = #{id}
]]>
</delete>

<!-- 세션 삭제 -->
<delete id="deleteSessionBySId">
<![CDATA[
	DELETE FROM session WHERE sessionId = #{sessionid}
]]>
</delete>
</mapper>